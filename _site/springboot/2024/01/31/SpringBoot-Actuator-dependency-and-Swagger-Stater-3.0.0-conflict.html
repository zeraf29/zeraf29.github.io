<ol>
  <li>Issue
    <ul>
      <li>When I use both Actuator and Swagger in a project, I met below error message</li>
    </ul>
    <ul>
      <li>ERROR org.springframework.boot.SpringApplication: Application run failed
org.springframework.context.ApplicationContextException: Failed to start bean ‘documentationPluginsBootstrapper’
      - Environment</li>
      <li>Spring boot: 2.7.17</li>
      <li>Spring Actuator: Same version with Spring boot</li>
      <li>Spring fox swagger: 3.0.0
        <ul>
          <li>io.springfox:springfox-swagger2:3.0.0</li>
          <li>io.springfox:springfox-swagger-ui:3.0.0</li>
          <li>io.springfox:springfox-boot-starter:3.0.0</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Reason
    <ul>
      <li>Swagger and Actuator, they two are access endpoint in spring boot. So they have conflict of dependency each other.</li>
      <li>Springfox swagger assume that Spring MVC use to Ant-based path matcher. But Upper Spring MVC 2.6.x is changed from Ant-based path matcher to PathPattern-based matcher.</li>
      <li>Both two make this error</li>
    </ul>
  </li>
  <li>Solution
    <ul>
      <li>Put below option under application.yml
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spring:
  mvc:
 pathmatch:
   matching-strategy: ant_path_matcher
</code></pre></div>        </div>
      </li>
      <li>And then, Regist BeanPostProcessor bean for SpringfoxHandler like below example
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@Configuration
public class Config {
@Bean
public static BeanPostProcessor springfoxHandlerProviderBeanPostProcessor() {
return new BeanPostProcessor() {

     @Override
     public Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException {
         if (bean instanceof WebMvcRequestHandlerProvider || bean instanceof WebFluxRequestHandlerProvider) {
             customizeSpringfoxHandlerMappings(getHandlerMappings(bean));
         }
         return bean;
     }

     private &lt;T extends RequestMappingInfoHandlerMapping&gt; void customizeSpringfoxHandlerMappings(List&lt;T&gt; mappings) {
         List&lt;T&gt; copy = mappings.stream()
                 .filter(mapping -&gt; mapping.getPatternParser() == null)
                 .collect(Collectors.toList());
         mappings.clear();
         mappings.addAll(copy);
     }

     @SuppressWarnings("unchecked")
     private List&lt;RequestMappingInfoHandlerMapping&gt; getHandlerMappings(Object bean) {
         try {
             Field field = ReflectionUtils.findField(bean.getClass(), "handlerMappings");
             field.setAccessible(true);
             return (List&lt;RequestMappingInfoHandlerMapping&gt;) field.get(bean);
         } catch (IllegalArgumentException | IllegalAccessException e) {
             throw new IllegalStateException(e);
         }
     }
 };
 }
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>Reference
    <ul>
      <li>https://dkswnkk.tistory.com/672</li>
    </ul>
  </li>
</ol>
